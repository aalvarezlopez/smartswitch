/**
 * @file graphics.c
 * @brief Graphics utils
 * @author Adrian Alvarez Lopez
 * @version 1.0.0
 * @date 2023-09-22
 *
 *
 * +--------> X
 * |
 * |
 * |
 * v
 *
 * Y
 */

#include "graphics.h"
#include "stdio.h"
#include "display.h"


#define CHAR_HEIGHT 8u
#define CHAR_WIDTH 5u
#define ASCII_TABLE_OFFSET 32u
#define BIG_DIGIT_HEIGHT 36u
#define BIG_DIGIT_WIDTH 24u
#define SMALL_DIGIT_HEIGHT 24u
#define SMALL_DIGIT_WIDTH 16u

uint16_t digits_small[][24]= {{0xffff,  0xffff,  0xf1ff,  0xe03f, 0xcf1f,  0xcf8f, 0xcfcf,  0xcfe7, 0xcfe7,  0xcff3,  0xcff3,  0xcff3,  0xcff3, 0xe7f9, 0xe7f9,  0xe3f9,  0xf3f9, 0xf9f1,  0xf8f3,  0xfe03,  0xff8f,  0xffff, 0xffff,  0xffff},
    {0xffff,  0xffff,  0xfcff,  0xfcff, 0xfe7f,  0xfe7f,  0xfe7f,  0xfe7f, 0xff3f, 0xff3f,  0xff3f,  0xff3f,  0xff9f, 0xff9f,  0xff9f,  0xff9f,  0xf8cf, 0xfc0f,  0xff0f,  0xffcf,  0xffe7,  0xffff, 0xffff,  0xffff},
    {0xffff,  0xffff,  0xc00f,  0xc007, 0xc7ff,  0xe7ff,  0xf3ff,  0xf9ff, 0xfc7f, 0xfe3f,  0xff1f,  0xffcf,  0xffe3, 0xfff3,  0xfff1,  0xfff9,  0xfff9, 0xfff9,  0xf9f1,  0xfc03,  0xff8f,  0xffff, 0xffff,  0xffff},
    {0xffff,  0xffff,  0xf0ff,  0x801f, 0xff8f,  0xffe7,  0xffe7,  0xffe3, 0xffe3, 0xffe7,  0xffc7,  0xfe0f,  0xfe0f, 0xffe7,  0xfff3,  0xfff9,  0xfff9, 0xfff9, 0xfff1,  0xfc03,  0xff0f,  0xffff, 0xffff,  0xffff },
    {0xffff,  0xffff,  0xff3f,  0xff3f, 0xff9f,  0xff9f,  0xff9f,  0x8003, 0x8003,  0xcfcf,  0xcfcf,  0xe7cf,  0xf3e7, 0xf9e7,  0xfce7,  0xfe67,  0xff33, 0xff93,  0xffc3,  0xffe3,  0xfff1,  0xffff, 0xffff,  0xffff },
    {0xffff,  0xffff,  0xe1ff,  0x803f, 0xff1f,  0xffcf,  0xffcf,  0xffe7, 0xffe7,  0xffc7,  0xffcf,  0xff0f,  0xf01f, 0xf0ff,  0xfbff,  0xf9ff,  0xf9ff, 0xfcff,  0xfcff,  0xfc01,  0xfe01,  0xffff, 0xffff,  0xffff },
    {0xffff,  0xffff,  0xf8ff,  0xe01f, 0xc78f,  0xcfc7,  0xcfe7,  0xcfe7, 0xcff3,  0xcff3,  0xcfe3,  0xc7e7,  0xe007, 0xe61f,  0xf3ff,  0xf1ff,  0xf8ff, 0xfc7f,  0xff1f,  0xff81,  0xfff9,  0xffff, 0xffff,  0xffff },
    {0xffff,  0xffff,  0xcfff,  0xcfff, 0xe7ff,  0xe7ff,  0xf3ff,  0xf3ff, 0xf1ff,  0xf9ff,  0xfcff,  0xfc7f,  0xfe7f, 0xff3f,  0xff1f,  0xff9f,  0xffcf, 0xffe7,  0xfff3,  0xe001,  0xf001,  0xffff, 0xffff,  0xffff },
    {0xffff,  0xffff,  0xf0ff,  0xc01f, 0xcf8f,  0x9fc7,  0x9fe7,  0x9fe7, 0xcfe7,  0xc7c7,  0xe38f,  0xf01f,  0xf80f, 0xf1e7,  0xf3f3,  0xf3f9,  0xf3f9, 0xf3f9,  0xf8f1,  0xfc03,  0xff0f,  0xffff, 0xffff,  0xffff },
    {0xffff,  0xffff,  0x8fff,  0x81ff, 0xfc7f,  0xff3f,  0xff9f,  0xffcf, 0xffe7,  0xf867,  0xf003,  0xe7e3,  0xe7f3, 0xe7f3,  0xe7f3,  0xe7f9,  0xe7f3, 0xf3f3,  0xf1e3,  0xf807,  0xff1f,  0xffff, 0xffff,  0xffff }};
uint32_t digits_big[][36]= {{0xffffff00, 0xffffff00, 0xfe1fff00, 0xf007ff00, 0xe001ff00, 0xe000ff00, 0xc1f07f00, 0xc3f83f00, 0xc3fc1f00, 0xc7fe1f00, 0xc7ff0f00, 0xc7ff0f00, 0xc7ff8700, 0xc7ff8700, 0xc7ffc700, 0xc3ffc300, 0xc3ffc300, 0xc3ffe300, 0xe3ffe100, 0xe1ffe100, 0xe1ffe100, 0xf1ffe100, 0xf0ffe100, 0xf0ffe100, 0xf87fe100, 0xf83fe100, 0xfc3fe100, 0xfe1fe100, 0xfe07c300, 0xff000300, 0xffc00700, 0xffe00f00, 0xfffc3f00, 0xffffff00, 0xffffff00, 0xffffff00},
    {0xffffff00, 0xffffff00, 0xff8fff00, 0xff87ff00, 0xff87ff00, 0xffc7ff00, 0xffc7ff00, 0xffc3ff00, 0xffc3ff00, 0xffc3ff00, 0xffe3ff00, 0xffe1ff00, 0xffe1ff00, 0xffe1ff00, 0xfff1ff00, 0xfff0ff00, 0xfff0ff00, 0xfff0ff00, 0xfff8ff00, 0xfff8ff00, 0xfff87f00, 0xfff87f00, 0xfffc7f00, 0xfffc7f00, 0xfe3c3f00, 0xfe0c3f00, 0xfe003f00, 0xff803f00, 0xffe01f00, 0xfff81f00, 0xfffc1f00, 0xffff1f00, 0xffff8f00, 0xffffff00, 0xffffff00, 0xffffff00},
    {0xffffff00, 0xffffff00, 0x80001f00, 0x80001f00, 0x80001f00, 0xc0001f00, 0xc3ffff00, 0xe1ffff00, 0xf1ffff00, 0xf0ffff00, 0xf83fff00, 0xfc1fff00, 0xfe0fff00, 0xff03ff00, 0xffc1ff00, 0xffe0ff00, 0xfff83f00, 0xfffc1f00, 0xfffe0f00, 0xffff0700, 0xffff8300, 0xffffc300, 0xffffe100, 0xffffe100, 0xffffe100, 0xffffe100, 0xffffe100, 0xfe7fe100, 0xfe1fc100, 0xfe000300, 0xff000300, 0xffc00f00, 0xfff83f00, 0xffffff00, 0xffffff00, 0xffffff00},
    {0xffffff00, 0xffffff00, 0xfc0fff00, 0xe000ff00, 0xc0003f00, 0xc0001f00, 0xc7fc0f00, 0xffff0f00, 0xffff8700, 0xffff8700, 0xffffc700, 0xffffc300, 0xffffc300, 0xffffc300, 0xffff8700, 0xffff8700, 0xfffe0f00, 0xffc01f00, 0xffc03f00, 0xffc03f00, 0xffe00f00, 0xffff0700, 0xffffc300, 0xffffe100, 0xfffff100, 0xfffff000, 0xfffff000, 0xfffff000, 0xff9fe100, 0xff800100, 0xff800300, 0xffe00700, 0xfffc3f00, 0xffffff00, 0xffffff00, 0xffffff00},
    {0xffffff00, 0xffffff00, 0xfff87f00, 0xfff87f00, 0xfffc7f00, 0xfffc7f00, 0xfffc3f00, 0xfffc3f00, 0xfffe3f00, 0xfffe3f00, 0x80000300, 0x80000300, 0xc0000100, 0xc0000100, 0xe3ff1f00, 0xe1ff0f00, 0xf1ff0f00, 0xf8ff8f00, 0xfc7f8f00, 0xfc3f8700, 0xfe1f8700, 0xff0fc700, 0xff87c700, 0xffc3c300, 0xffe1c300, 0xfff0e300, 0xfff86300, 0xfffc2100, 0xfffe0100, 0xffff0100, 0xffff8100, 0xffffe000, 0xfffff000, 0xffffff00, 0xffffff00, 0xffffff00},
    {0xffffff00, 0xffffff00, 0xfc1fff00, 0xc003ff00, 0x8000ff00, 0x80003f00, 0xcff01f00, 0xfffc1f00, 0xfffe0f00, 0xffff0f00, 0xffff8f00, 0xffff8700, 0xffff8700, 0xffff8700, 0xffff8700, 0xffff0700, 0xffff0f00, 0xfffc0f00, 0xfff01f00, 0xfc001f00, 0xfe007f00, 0xfe01ff00, 0xfe0fff00, 0xff1fff00, 0xff1fff00, 0xff8fff00, 0xff8fff00, 0xff87ff00, 0xffc7ff00, 0xffc00000, 0xffc00000, 0xffc00000, 0xffe00000, 0xffffff00, 0xffffff00, 0xffffff00},
    {0xffffff00, 0xffffff00, 0xfe1fff00, 0xf003ff00, 0xe000ff00, 0xc0007f00, 0xc3f83f00, 0x87fc1f00, 0x87fe1f00, 0x87ff0f00, 0x8fff0f00, 0x8fff8f00, 0x87ff8f00, 0x87ff8f00, 0x87ff8f00, 0x87ff0f00, 0xc3fe0f00, 0xc0000f00, 0xc0001f00, 0xe0003f00, 0xe1c1ff00, 0xe1ffff00, 0xf0ffff00, 0xf87fff00, 0xf83fff00, 0xfc1fff00, 0xfe0fff00, 0xff03ff00, 0xff807f00, 0xffe00100, 0xfff80100, 0xfffe0100, 0xfffff100, 0xffffff00, 0xffffff00, 0xffffff00},
    {0xffffff00, 0xffffff00, 0xc7ffff00, 0xc3ffff00, 0xc3ffff00, 0xe3ffff00, 0xe1ffff00, 0xe1ffff00, 0xf0ffff00, 0xf0ffff00, 0xf87fff00, 0xf87fff00, 0xfc3fff00, 0xfe3fff00, 0xfe1fff00, 0xff0fff00, 0xff0fff00, 0xff87ff00, 0xffc3ff00, 0xffc3ff00, 0xffe1ff00, 0xfff0ff00, 0xfff87f00, 0xfff87f00, 0xfffc3f00, 0xfffe1f00, 0xffff0f00, 0xffff8700, 0xffffc300, 0xf0000100, 0xf0000100, 0xf0000100, 0xf0000100, 0xffffff00, 0xffffff00, 0xffffff00},
    {0xffffff00, 0xffffff00, 0xfe0fff00, 0xf001ff00, 0xc0007f00, 0xc0003f00, 0x83f81f00, 0x87fe1f00, 0x87ff0f00, 0x8fff0f00, 0x8fff8f00, 0x87ff8f00, 0xc7ff8f00, 0xc3ff0f00, 0xe1ff0f00, 0xf0fe1f00, 0xf8783f00, 0xfe007f00, 0xff003f00, 0xfe0e0f00, 0xfc3f8700, 0xfc7fc300, 0xf87fe300, 0xf87fe100, 0xf87ff100, 0xfc7ff100, 0xfc3ff100, 0xfc1fe100, 0xfe0fc100, 0xff000100, 0xff800300, 0xffc00700, 0xfff83f00, 0xffffff00, 0xffffff00, 0xffffff00},
    {0xffffff00, 0xffffff00, 0xffffff00, 0x87ffff00, 0x803fff00, 0xc00fff00, 0xc003ff00, 0xff00ff00, 0xffe07f00, 0xfff83f00, 0xfffc1f00, 0xfffe0f00, 0xffff0f00, 0xffff8700, 0xffff8700, 0xffc3c300, 0xfe000300, 0xfc000100, 0xf8000100, 0xf87fc100, 0xf0ffe100, 0xf0fff100, 0xf0fff000, 0xf0fff000, 0xf0fff000, 0xf8fff000, 0xf87ff000, 0xf87ff000, 0xfc3fe100, 0xfe0fc100, 0xfe000300, 0xff800300, 0xffc00700, 0xfff83f00, 0xffffff00, 0xffffff00}};
/*
 *    Font definition -- 5 x 8 pixels -- MONO-SPACED;  96 ASCII characters
 *    Char cell: 5 x 8 pixels (8 bytes/char); each byte is a row of 5 pixels, left justified.
 *
 *    Format:  char bits = b7..b3,  blank bits = b2, b1 and b0;  b7 is LHS.
 *             Lower-case descenders use the 8th byte.
 *
 * */
const uint8_t  font_table_mono_5x8[] =
{
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,   // space
0x20, 0x20, 0x20, 0x20, 0x20, 0x00, 0x20, 0x00,   // !
0x50, 0x50, 0x50, 0x00, 0x00, 0x00, 0x00, 0x00,   // "
0x50, 0x50, 0xF8, 0x50, 0xF8, 0x50, 0x50, 0x00,   // #
0x20, 0x78, 0xA0, 0x70, 0x28, 0xF0, 0x20, 0x00,   // $
0xC0, 0xC8, 0x10, 0x20, 0x40, 0x98, 0x18, 0x00,   // %
0x20, 0x50, 0x50, 0x60, 0xA8, 0x90, 0x68, 0x00,   // &
0x20, 0x20, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00,   // '
0x10, 0x20, 0x40, 0x40, 0x40, 0x20, 0x10, 0x00,   // (
0x40, 0x20, 0x10, 0x10, 0x10, 0x20, 0x40, 0x00,   // )
0x00, 0x20, 0xA8, 0x70, 0xA8, 0x20, 0x00, 0x00,   // *
0x00, 0x20, 0x20, 0xF8, 0x20, 0x20, 0x00, 0x00,   // +
0x00, 0x00, 0x00, 0x00, 0x60, 0x60, 0x20, 0x40,   // ,
0x00, 0x00, 0x00, 0xF8, 0x00, 0x00, 0x00, 0x00,   // -
0x00, 0x00, 0x00, 0x00, 0x00, 0x60, 0x60, 0x00,   // .
0x04, 0x08, 0x10, 0x20, 0x40, 0x80, 0x00, 0x00,   // /

0x70, 0x88, 0x98, 0xA8, 0xC8, 0x88, 0x70, 0x00,   // 0
0x20, 0x60, 0x20, 0x20, 0x20, 0x20, 0x70, 0x00,   // 1
0x70, 0x88, 0x08, 0x10, 0x20, 0x40, 0xF8, 0x00,   // 2
0xF8, 0x10, 0x20, 0x10, 0x08, 0x88, 0x70, 0x00,   // 3
0x10, 0x30, 0x50, 0x90, 0xF8, 0x10, 0x10, 0x00,   // 4
0xF8, 0x80, 0xF0, 0x08, 0x08, 0x88, 0x70, 0x00,   // 5
0x30, 0x40, 0x80, 0xF0, 0x88, 0x88, 0x70, 0x00,   // 6
0xF8, 0x08, 0x10, 0x20, 0x40, 0x40, 0x40, 0x00,   // 7
0x70, 0x88, 0x88, 0x70, 0x88, 0x88, 0x70, 0x00,   // 8
0x70, 0x88, 0x88, 0x78, 0x08, 0x10, 0x60, 0x00,   // 9
0x00, 0x60, 0x60, 0x00, 0x60, 0x60, 0x00, 0x00,   // :
0x00, 0x60, 0x60, 0x00, 0x60, 0x60, 0x20, 0x40,   // ;
0x08, 0x10, 0x20, 0x40, 0x20, 0x10, 0x08, 0x00,   // <
0x00, 0x00, 0xF8, 0x00, 0xF8, 0x00, 0x00, 0x00,   // =
0x80, 0x40, 0x20, 0x10, 0x20, 0x40, 0x80, 0x00,   // >
0x70, 0x88, 0x08, 0x10, 0x20, 0x00, 0x20, 0x00,   // ?

0x30, 0x48, 0xB8, 0xA8, 0xB8, 0x80, 0x78, 0x00,   // @
0x70, 0x88, 0x88, 0xF8, 0x88, 0x88, 0x88, 0x00,   // A
0xF0, 0x88, 0x88, 0xF0, 0x88, 0x88, 0xF0, 0x00,   // B
0x70, 0x88, 0x80, 0x80, 0x80, 0x88, 0x70, 0x00,   // C
0xE0, 0x90, 0x88, 0x88, 0x88, 0x90, 0xE0, 0x00,   // D
0xF8, 0x80, 0x80, 0xF0, 0x80, 0x80, 0xF8, 0x00,   // E
0xF8, 0x80, 0x80, 0xF0, 0x80, 0x80, 0x80, 0x00,   // F
0x78, 0x80, 0x80, 0x98, 0x88, 0x88, 0x78, 0x00,   // G
0x88, 0x88, 0x88, 0xF8, 0x88, 0x88, 0x88, 0x00,   // H
0x70, 0x20, 0x20, 0x20, 0x20, 0x20, 0x70, 0x00,   // I
0x38, 0x10, 0x10, 0x10, 0x10, 0x90, 0x60, 0x00,   // J
0x88, 0x90, 0xA0, 0xC0, 0xA0, 0x90, 0x88, 0x00,   // K
0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0xF8, 0x00,   // L
0x88, 0xD8, 0xA8, 0xA8, 0x88, 0x88, 0x88, 0x00,   // M
0x88, 0xC8, 0xA8, 0x98, 0x88, 0x88, 0x88, 0x00,   // N
0x70, 0x88, 0x88, 0x88, 0x88, 0x88, 0x70, 0x00,   // O

0xF0, 0x88, 0x88, 0xF0, 0x80, 0x80, 0x80, 0x00,   // P
0x70, 0x88, 0x88, 0x88, 0xA8, 0x90, 0x68, 0x04,   // Q
0xF0, 0x88, 0x88, 0xF0, 0xA0, 0x90, 0x88, 0x00,   // R
0x70, 0x88, 0x80, 0x70, 0x08, 0x88, 0x70, 0x00,   // S
0xF8, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x00,   // T
0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x70, 0x00,   // U
0x88, 0x88, 0x88, 0x50, 0x50, 0x20, 0x20, 0x00,   // V
0x88, 0x88, 0x88, 0xA8, 0xA8, 0xA8, 0x50, 0x00,   // W
0x88, 0x88, 0x50, 0x20, 0x50, 0x88, 0x88, 0x00,   // X
0x88, 0x88, 0x88, 0x70, 0x20, 0x20, 0x20, 0x00,   // Y
0xF8, 0x08, 0x10, 0x20, 0x40, 0x80, 0xF8, 0x00,   // Z
0x38, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x38,   // [
0x00, 0x80, 0x40, 0x20, 0x10, 0x08, 0x04, 0x00,   // back-slash
0xE0, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0xE0,   // ]
0x20, 0x50, 0x88, 0x00, 0x00, 0x00, 0x00, 0x00,   // ^
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xF8, 0x00,   // _

0x20, 0x20, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00,   // `
0x00, 0x00, 0x70, 0x08, 0x78, 0x88, 0x78, 0x00,   // a
0x80, 0x80, 0xB0, 0xC8, 0x88, 0x88, 0xF0, 0x00,   // b
0x00, 0x00, 0x70, 0x88, 0x80, 0x80, 0x70, 0x00,   // c
0x08, 0x08, 0x68, 0x98, 0x88, 0x88, 0x78, 0x00,   // d
0x00, 0x00, 0x70, 0x88, 0xF8, 0x80, 0x70, 0x00,   // e
0x30, 0x48, 0x40, 0xF0, 0x40, 0x40, 0x40, 0x00,   // f
0x00, 0x00, 0x78, 0x88, 0x98, 0x68, 0x08, 0x70,   // g
0x80, 0x80, 0xB0, 0xC8, 0x88, 0x88, 0x88, 0x00,   // h
0x20, 0x00, 0x60, 0x20, 0x20, 0x20, 0x70, 0x00,   // i
0x10, 0x00, 0x30, 0x10, 0x10, 0x10, 0x90, 0x60,   // j
0x80, 0x80, 0x90, 0xA0, 0xD0, 0x88, 0x88, 0x00,   // k
0x60, 0x20, 0x20, 0x20, 0x20, 0x20, 0x70, 0x00,   // l
0x00, 0x00, 0xD0, 0xA8, 0xA8, 0xA8, 0x88, 0x00,   // m
0x00, 0x00, 0xF0, 0x88, 0x88, 0x88, 0x88, 0x00,   // n
0x00, 0x00, 0x70, 0x88, 0x88, 0x88, 0x70, 0x00,   // o

0x00, 0x00, 0xF0, 0x88, 0x88, 0xF0, 0x80, 0x80,   // p
0x00, 0x00, 0x78, 0x88, 0x88, 0x78, 0x08, 0x08,   // q
0x00, 0x00, 0xB0, 0xC8, 0x80, 0x80, 0x80, 0x00,   // r
0x00, 0x00, 0x70, 0x80, 0x70, 0x08, 0x70, 0x00,   // s
0x40, 0x40, 0xE0, 0x40, 0x40, 0x48, 0x30, 0x00,   // t
0x00, 0x00, 0x88, 0x88, 0x88, 0x98, 0x68, 0x00,   // u
0x00, 0x00, 0x88, 0x88, 0x88, 0x50, 0x20, 0x00,   // v
0x00, 0x00, 0x88, 0x88, 0xA8, 0xA8, 0x50, 0x00,   // w
0x00, 0x00, 0x88, 0x50, 0x20, 0x50, 0x88, 0x00,   // x
0x00, 0x00, 0x88, 0x88, 0x88, 0x78, 0x08, 0xF0,   // y
0x00, 0x00, 0xF8, 0x10, 0x20, 0x40, 0xF8, 0x00,   // z
0x18, 0x20, 0x20, 0x40, 0x40, 0x20, 0x20, 0x18,   // {
0x20, 0x20, 0x20, 0x00, 0x20, 0x20, 0x20, 0x00,   // |
                                                                                                                                                                                            0xC0, 0x20, 0x20, 0x10, 0x10, 0x20, 0x20, 0xC0,   // }
0x00, 0xC8, 0x30, 0x00, 0x00, 0x00, 0x00, 0x00,   // ~
0xA8, 0x50, 0xA8, 0x50, 0xA8, 0x50, 0xA8, 0x00    // del
};

void gpx_putString(const char * str, uint8_t x, uint8_t y)
{
    for(uint8_t i = 0; i < strlen(str); i++){
        gpx_putChar(str[i], x + ((CHAR_WIDTH + 2) * i), y);
    }
}

void gpx_putChar(uint8_t uc, uint8_t x, uint8_t y)
{
    uint8_t page, index;
    if( uc < ASCII_TABLE_OFFSET){
        /* NOT PRINTABLE */
    }else{
        for(uint8_t i = 0; i < CHAR_HEIGHT; i++){
            uint16_t table_index = ((uc-ASCII_TABLE_OFFSET)*8) + i;
            page = (y+i) / DISPLAY_PAGE_SIZE;
            index = (y+i) % DISPLAY_PAGE_SIZE;
            for(uint8_t j = 0; j < CHAR_HEIGHT; j++){
                if((font_table_mono_5x8[ table_index ] >> ( 7 - j) & 0x1) == 0){
                    displayBuffer[page][x + j] &= ~(1 << index);
                }else{
                    displayBuffer[page][x + j] |= (1 << index);
                }
            }
        }
    }
}

void gpx_putLargeDigit(uint8_t ud, uint8_t x, uint8_t y)
{
    uint8_t page, index;
    uint16_t table_index = (ud-'0');
    for(uint8_t i = 0; i < BIG_DIGIT_HEIGHT; i++){
        page = (y+(BIG_DIGIT_HEIGHT-i)) / DISPLAY_PAGE_SIZE;
        index = (y+(BIG_DIGIT_HEIGHT-i)) % DISPLAY_PAGE_SIZE;
        uint32_t row = digits_big[table_index][i];
        for(uint8_t j = 0; j < BIG_DIGIT_WIDTH; j++){
            if((row >> ( 31 - j) & 0x1) == 0){
                displayBuffer[page][x + j] |= (1 << index);
            }else{
                displayBuffer[page][x + j] &= ~(1 << index);
            }
        }
    }
}

void gpx_putSmallDigit(uint8_t ud, uint8_t x, uint8_t y)
{
    uint8_t page, index;
    uint16_t table_index = (ud-'0');
    for(uint8_t i = 0; i < SMALL_DIGIT_HEIGHT; i++){
        page = (y+(SMALL_DIGIT_HEIGHT-i)) / DISPLAY_PAGE_SIZE;
        index = (y+(SMALL_DIGIT_HEIGHT-i)) % DISPLAY_PAGE_SIZE;
        uint16_t row = digits_small[table_index][i];
        for(uint8_t j = 0; j < SMALL_DIGIT_WIDTH; j++){
            if((row >> ( 15 - j) & 0x1) == 0){
                displayBuffer[page][x + j] |= (1 << index);
            }else{
                displayBuffer[page][x + j] &= ~(1 << index);
            }
        }
    }
}
